"""デモ用サンプルCSV生成（90件: 東京本社30件 / 大阪支社30件 / 名古屋支社30件）

例外内訳（10件）:
  TAX_MISMATCH      x3  (TK-0026, TK-0028, NG-0014)
  DISCOUNT_MISMATCH x3  (OS-0010, NG-0010, NG-0020)
  TOTAL_MISMATCH    x4  (TK-0015, OS-0026, OS-0028, NG-0028)
"""

import io
import csv

_HEADER = [
    "branch",
    "invoice_no",
    "customer_name",
    "subtotal_ex_tax",
    "tax_amount",
    "total_in_tax",
    "discount_amount",
    "discount_rate",
]

# fmt: off
_ROWS = [
    # ── 東京本社 (30件: OK=27, TAX_MISMATCH=2, TOTAL_MISMATCH=1) ──
    ("東京本社","TK-2026-0001","東京電力エナジーパートナー",1284500,128450,1412950,"",""),
    ("東京本社","TK-2026-0002","東京ガスネットワーク",856000,85600,941600,"",""),
    ("東京本社","TK-2026-0003","ENEOS電力",432000,43200,475200,"",""),
    ("東京本社","TK-2026-0004","出光興産",1950000,195000,2145000,"",""),
    ("東京本社","TK-2026-0005","丸紅エネルギー",678000,67800,745800,"",""),
    ("東京本社","TK-2026-0006","住友商事パワー&モビリティ",2340000,234000,2574000,"",""),
    ("東京本社","TK-2026-0007","三菱HCキャピタル",1120000,112000,1232000,"",""),
    ("東京本社","TK-2026-0008","日立パワーソリューションズ",3456000,345600,3801600,"",""),
    ("東京本社","TK-2026-0009","東芝エネルギーシステムズ",2890000,289000,3179000,"",""),
    ("東京本社","TK-2026-0010","富士電機",567800,56780,624580,"",""),
    ("東京本社","TK-2026-0011","明電舎",1045000,104500,1149500,"",""),
    ("東京本社","TK-2026-0012","日本ガイシ",782000,78200,860200,"",""),
    ("東京本社","TK-2026-0013","古河電気工業",1560000,156000,1716000,"",""),
    ("東京本社","TK-2026-0014","住友電気工業",2210000,221000,2431000,"",""),
    ("東京本社","TK-2026-0015","電源開発",4500000,450000,4950300,"",""),  # TOTAL_MISMATCH +300
    ("東京本社","TK-2026-0016","JERA",8900000,890000,9790000,"",""),
    ("東京本社","TK-2026-0017","東京センチュリー",345000,34500,379500,"",""),
    ("東京本社","TK-2026-0018","三井住友ファイナンス&リース",1890000,189000,2079000,"",""),
    ("東京本社","TK-2026-0019","NTTアノードエナジー",2560000,256000,2816000,"",""),
    ("東京本社","TK-2026-0020","関電工",1340000,134000,1474000,"",""),
    ("東京本社","TK-2026-0021","きんでん",985000,98500,1083500,"",""),
    ("東京本社","TK-2026-0022","ユアテック",456000,45600,501600,"",""),
    ("東京本社","TK-2026-0023","トーエネック",1230000,123000,1353000,"",""),
    ("東京本社","TK-2026-0024","九電工",2100000,210000,2310000,"",""),
    ("東京本社","TK-2026-0025","中電工",876000,87600,963600,"",""),
    ("東京本社","TK-2026-0026","シーメンスエナジー",5670000,567001,6237001,"",""),  # TAX_MISMATCH +1
    ("東京本社","TK-2026-0027","ABBジャパン",3420000,342000,3762000,"",""),
    ("東京本社","TK-2026-0028","GEベルノバ・ジャパン",4210000,421001,4631001,"",""),  # TAX_MISMATCH +1
    ("東京本社","TK-2026-0029","横河電機",1560000,156000,1716000,"",""),
    ("東京本社","TK-2026-0030","ダイヘン",890000,89000,979000,"",""),
    # ── 大阪支社 (30件: OK=27, DISCOUNT_MISMATCH=1, TOTAL_MISMATCH=2) ──
    ("大阪支社","OS-2026-0001","関西電力",3280000,328000,3608000,"",""),
    ("大阪支社","OS-2026-0002","大阪ガス",1450000,145000,1595000,"",""),
    ("大阪支社","OS-2026-0003","岩谷産業",678000,67800,745800,"",""),
    ("大阪支社","OS-2026-0004","ダイキン工業",2340000,234000,2574000,"",""),
    ("大阪支社","OS-2026-0005","パナソニックエナジー",1890000,184000,2024000,50000,""),  # OK (discount_amount)
    ("大阪支社","OS-2026-0006","シャープエネルギーソリューション",456000,45600,501600,"",""),
    ("大阪支社","OS-2026-0007","住友電設",1120000,112000,1232000,"",""),
    ("大阪支社","OS-2026-0008","コベルコパワー",3450000,345000,3795000,"",""),
    ("大阪支社","OS-2026-0009","神戸製鋼所",2670000,267000,2937000,"",""),
    ("大阪支社","OS-2026-0010","川崎重工業",5120000,502000,5522200,100000,""),  # DISCOUNT_MISMATCH +200
    ("大阪支社","OS-2026-0011","クボタ",890000,89000,979000,"",""),
    ("大阪支社","OS-2026-0012","栗田工業",1560000,156000,1716000,"",""),
    ("大阪支社","OS-2026-0013","タクマ",2340000,234000,2574000,"",""),
    ("大阪支社","OS-2026-0014","荏原製作所",1780000,178000,1958000,"",""),
    ("大阪支社","OS-2026-0015","三菱電機関西支社",4560000,456000,5016000,"",""),
    ("大阪支社","OS-2026-0016","オムロンフィールドエンジ",345000,34500,379500,"",""),
    ("大阪支社","OS-2026-0017","日新電機",1230000,123000,1353000,"",""),
    ("大阪支社","OS-2026-0018","ジーエス・ユアサ",2100000,210000,2310000,"",""),
    ("大阪支社","OS-2026-0019","ニチコン",567000,56700,623700,"",""),
    ("大阪支社","OS-2026-0020","京セラ",1890000,189000,2079000,"",""),
    ("大阪支社","OS-2026-0021","村田製作所",3210000,321000,3531000,"",""),
    ("大阪支社","OS-2026-0022","ローム",876000,87600,963600,"",""),
    ("大阪支社","OS-2026-0023","日本電産",2450000,245000,2695000,"",""),
    ("大阪支社","OS-2026-0024","島津製作所",1340000,134000,1474000,"",""),
    ("大阪支社","OS-2026-0025","堀場製作所",985000,98500,1083500,"",""),
    ("大阪支社","OS-2026-0026","GSユアサ",1560000,156000,1716200,"",""),  # TOTAL_MISMATCH +200
    ("大阪支社","OS-2026-0027","三菱重工サーマルシステムズ",2780000,278000,3058000,"",""),
    ("大阪支社","OS-2026-0028","IHI回転機械エンジニアリング",4560000,456000,5016500,"",""),  # TOTAL_MISMATCH +500
    ("大阪支社","OS-2026-0029","ヤンマーエネルギーシステム",890000,89000,979000,"",""),
    ("大阪支社","OS-2026-0030","ダイヘン関西",1120000,112000,1232000,"",""),
    # ── 名古屋支社 (30件: OK=26, TAX_MISMATCH=1, DISCOUNT_MISMATCH=2, TOTAL_MISMATCH=1) ──
    ("名古屋支社","NG-2026-0001","中部電力ミライズ",2890000,289000,3179000,"",""),
    ("名古屋支社","NG-2026-0002","東邦ガス",1560000,156000,1716000,"",""),
    ("名古屋支社","NG-2026-0003","トヨタ自動車",5670000,567000,6237000,"",""),
    ("名古屋支社","NG-2026-0004","デンソー",3420000,342000,3762000,"",""),
    ("名古屋支社","NG-2026-0005","アイシン",1890000,183330,2016630,"",0.03),  # OK (discount_rate)
    ("名古屋支社","NG-2026-0006","豊田自動織機",2340000,234000,2574000,"",""),
    ("名古屋支社","NG-2026-0007","日本特殊陶業",876000,87600,963600,"",""),
    ("名古屋支社","NG-2026-0008","リンナイ",567000,56700,623700,"",""),
    ("名古屋支社","NG-2026-0009","パロマ",1230000,123000,1353000,"",""),
    ("名古屋支社","NG-2026-0010","LIXIL中部",2100000,199500,2194700,"",0.05),  # DISCOUNT_MISMATCH +200
    ("名古屋支社","NG-2026-0011","中電工事",678000,67800,745800,"",""),
    ("名古屋支社","NG-2026-0012","トーエネック中部",1450000,145000,1595000,"",""),
    ("名古屋支社","NG-2026-0013","三菱電機中部支社",3210000,321000,3531000,"",""),
    ("名古屋支社","NG-2026-0014","東芝プラントシステム",2560000,256001,2816001,"",""),  # TAX_MISMATCH +1
    ("名古屋支社","NG-2026-0015","日立プラントサービス",4500000,450000,4950000,"",""),
    ("名古屋支社","NG-2026-0016","JFEエンジニアリング",1890000,189000,2079000,"",""),
    ("名古屋支社","NG-2026-0017","IHIプラント",2670000,267000,2937000,"",""),
    ("名古屋支社","NG-2026-0018","千代田化工建設",5120000,512000,5632000,"",""),
    ("名古屋支社","NG-2026-0019","日揮ホールディングス",3780000,378000,4158000,"",""),
    ("名古屋支社","NG-2026-0020","大林組エネルギー",1340000,131320,1444720,"",0.02),  # DISCOUNT_MISMATCH +200
    ("名古屋支社","NG-2026-0021","鹿島建設",2450000,245000,2695000,"",""),
    ("名古屋支社","NG-2026-0022","清水建設",1780000,178000,1958000,"",""),
    ("名古屋支社","NG-2026-0023","大成建設",3450000,345000,3795000,"",""),
    ("名古屋支社","NG-2026-0024","竹中工務店",2890000,289000,3179000,"",""),
    ("名古屋支社","NG-2026-0025","NTTファシリティーズ東海",985000,98500,1083500,"",""),
    ("名古屋支社","NG-2026-0026","NECフィールディング",1120000,112000,1232000,"",""),
    ("名古屋支社","NG-2026-0027","富士通エフサス",567000,56700,623700,"",""),
    ("名古屋支社","NG-2026-0028","日本IBM中部",2340000,234000,2574500,"",""),  # TOTAL_MISMATCH +500
    ("名古屋支社","NG-2026-0029","NEC中部テレコム",890000,89000,979000,"",""),
    ("名古屋支社","NG-2026-0030","シスコシステムズ合同会社",1560000,156000,1716000,"",""),
]
# fmt: on


def generate_demo_csv() -> str:
    buf = io.StringIO()
    writer = csv.writer(buf)
    writer.writerow(_HEADER)
    for row in _ROWS:
        writer.writerow(row)
    return buf.getvalue()
